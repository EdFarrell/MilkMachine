<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>MilkMachine by EdFarrell</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">MilkMachine</h1>
      <h2 class="project-tagline">QGIS Python Plugin for creating KML from GPS data</h2>
      <a href="https://github.com/EdFarrell/MilkMachine" class="btn">View on GitHub</a>
      <a href="https://github.com/EdFarrell/MilkMachine/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/EdFarrell/MilkMachine/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="welcome-to-the-milkmachine-project-page" class="anchor" href="#welcome-to-the-milkmachine-project-page" aria-hidden="true"><span class="octicon octicon-link"></span></a>Welcome to the MilkMachine Project Page!</h1>

<p>MilkMachine is a QGIS Python Plugin for creating KML (keyhole markup language) files from GPS data. The code and components developed to support the 250 Miles Crossing Philadelphia project <a href="http://www.250miles.net/">http://www.250miles.net/</a>. MilkMachine will accept raw gps data in .csv format and allows for creation of KML tours, placemarks, models, audio attachment, spatial smoothing/filtering, and time editing. Once editing is complete, files can be exported to .kml or .kmz. An intermediate shapefile (.shp) is produced that will store the coded attribute information. No cow's milk (or milk of any kind) is produced.</p>

<h1>
<a id="page-contents" class="anchor" href="#page-contents" aria-hidden="true"><span class="octicon octicon-link"></span></a>Page Contents</h1>

<ul>
<li><a href="#quick-start">Quick-Start</a></li>
<li>
<a href="#examples">Examples</a>

<ul>
<li><a href="#input-file-format">Input File Format</a></li>
<li><a href="#example-1-create-a-kml-file-with-placemarks">Example 1: Create a .kml file with placemarks</a></li>
<li><a href="#example-2-create-a-kml-tour">Example 2: Create a .kml tour</a></li>
<li><a href="#example-3-sync-an-audio-file-to-your-tour">Example 3: Sync an audio file to your tour</a></li>
</ul>
</li>
<li><a href="#roadmap">Roadmap</a></li>
<li><a href="#authors-contributors-support">Authors, Contributors, Support</a></li>
</ul>

<h1>
<a id="quick-start" class="anchor" href="#quick-start" aria-hidden="true"><span class="octicon octicon-link"></span></a>Quick Start</h1>

<ul>
<li>QGIS (2.4 or above) (required)</li>
<li>Python SciPy (required)</li>
<li>Google Earth (optional, but necessary to view .kml)</li>
<li>VLC Media Player (optional, but necessary of syncing audio files)</li>
</ul>

<p>For full installation instructions see <a href="https://github.com/EdFarrell/MilkMachine">https://github.com/EdFarrell/MilkMachine</a>. The basic install sequence is that you have QGIS 2.4 (or above) installed (Windows, Mac, Linux). Mac and Linux ship with Python, the Windows version of QGIS will bring along it's own version of Python. Make sure that SciPy (<a href="http://www.scipy.org/install.html">http://www.scipy.org/install.html</a>) is installed. On Linux, just run this</p>

<pre><code>$ sudo apt-get install python-scipy
</code></pre>

<p>On Windows you can use pip</p>

<pre><code>pip install scipy
</code></pre>

<p>Now that your dependencies are complete, install MilkMachine into the ~/python/plugins directory for QGIS, if you are grabbing the source from GitHub. If the install worked, you should see the MilkMachine icon in your QGIS toolbar <img src="https://github.com/EdFarrell/MilkMachine/blob/master/src/MilkMachine/icon.png?raw=true" alt="MM Icon">. Google Earth is compatible on PC, Mac, &amp; Linux (<a href="http://www.google.com/earth/">http://www.google.com/earth/</a>), and so is VLC (<a href="http://www.videolan.org/vlc/index.html">http://www.videolan.org/vlc/index.html</a>).</p>

<h1>
<a id="examples" class="anchor" href="#examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h1>

<h2>
<a id="input-file-format" class="anchor" href="#input-file-format" aria-hidden="true"><span class="octicon octicon-link"></span></a>Input File Format</h2>

<p>Before you get started with using MilkMachine, you have to have some GPS data! To use MilkMachine, those data must be stored in a comma separated file (*.csv) and have 5 columns with sequential GPS locations. The columns that must be present (you can have more than these) are; </p>

<ul>
<li>
<strong>date</strong>: Date of the location. Can be in these formats; MM/DD/YYYY, DD/MM/YYYY, YYYY/MM/DD</li>
<li>
<strong>time</strong>: Time of the location. Must be HH:MM:SS, or HH:MM:SS.mmmmmm. mmmmmm is microseconds. See the Python datetime library for full spec (<a href="https://docs.python.org/2/library/datetime.html">https://docs.python.org/2/library/datetime.html</a>)</li>
<li>
<strong>x</strong>: Longitude. numeric, geographic coordinates (WGS84)</li>
<li>
<strong>y</strong>: Latitude. numeric, geographic coordinates (WGS84)</li>
<li>
<strong>altitude</strong>: Elevation in reference to sea level (could also be to "sea floor"). numeric, meters preferred.</li>
</ul>

<h2>
<a id="example-1-create-a-kml-file-with-placemarks" class="anchor" href="#example-1-create-a-kml-file-with-placemarks" aria-hidden="true"><span class="octicon octicon-link"></span></a>Example 1: Create a .kml file with placemarks</h2>

<p><img src="https://github.com/EdFarrell/MilkMachine/blob/master/dist/images/example1_import.PNG?raw=true" alt="Figure 1"><br>
<em><strong>Figure 1.</strong> MilkMachine import raw file. The around the block file can be found here</em> <a href="https://github.com/EdFarrell/MilkMachine/tree/master/sampledata/aroundtheblock">https://github.com/EdFarrell/MilkMachine/tree/master/sampledata/aroundtheblock</a>  </p>

<p><img src="https://github.com/EdFarrell/MilkMachine/blob/master/dist/images/example1_import_canvas.PNG?raw=true" alt="Figure 2"><br>
<em><strong>Figure 2.</strong> MilkMachine import layer drawn on map canvas</em></p>

<ol>
<li>Import a raw .csv GPS file by clicking the "Import GPS" button (Figure 1) and browsing to your csv file. The file must be formatted properly (see above) and have valid data in each of the rows. Once the file path appears in MilkMachine, click the "Draw Track" button. This will convert the .csv file to an ESRI Shapefile and the Shapefile will be added to the table of contents and the map canvas (Figure 2). The Shapefile is written to the same directory of your .csv file, and named the same. Also, many columns are added to the Shapefile, which will hold the .kml tag value pairs. Now your ready to edit!</li>
<li>Open up a QGIS edit session on the <strong>aroundtheblock</strong> layer.</li>
<li>Select all of the features in the <strong>aroundtheblock</strong> layer, and make sure that the layer is selected in the table of content. Only features that are selected will be changed by MilkMachine.</li>
<li>Navigate to the "Placemarks" tab. The <strong>aroundtheblock</strong> layer should be in the text box. Click the "Edit Points" checkbox (Figure 3). Now you are ready create your placemarks!</li>
<li>The "Icon Style" options control how the placemark will look. Here, I chose to color my placemark blue. The default placemark is the pushpin, but you can link to any icon. Just add the full URL to the "icon" option. You can also control how the label will look by using the "Label Style" options. Here, I took the defaults so it the labels will appear white. If you don't want labels at all, just change the scale value to 0. All of these options are taken directly from the the KML elements reference. You can hover over the options in MilkMachine to get an idea of what the field does, or you can go directly to the API reference pages (<a href="https://developers.google.com/kml/documentation/kmlreference">https://developers.google.com/kml/documentation/kmlreference</a>). Click the "Apply" button to build edit the <strong>aroundtheblock</strong> layer, this will apply the icon settings.</li>
<li>
<p>Navigate over to the "Export and Details" tab in MilkMachine. Click the "Export Track" button (Figure 4) and save as <strong>"aroundtheblock_basicplacemark.kml"</strong> in a directory of your choice.</p>

<p><img src="https://github.com/EdFarrell/MilkMachine/blob/master/dist/images/example1_placemark.PNG?raw=true" alt="Figure 3"><br>
<em><strong>Figure 3.</strong> Create placemarks for all of the selected features</em>  </p>

<p><img src="https://github.com/EdFarrell/MilkMachine/blob/master/dist/images/example1_placemark_export.PNG?raw=true" alt="Figure 4"><br>
<em><strong>Figure 4.</strong> Click the export button to export to .kml.</em></p>
</li>
<li>
<p>Open your newly exported <strong>aroundtheblock_basicplacemark.kml</strong> file by double clicking it (you must have Google Earth installed). It will launch in Google Earth (Figure 5). You'll notice that this track is a walk around the block in Philadelphia, PA, and that the placemarks are blue and have white labels. Click on the placemarks to see what time the placemark occured.</p>

<p><img src="https://github.com/EdFarrell/MilkMachine/blob/master/dist/images/example1_placemark_GE.PNG?raw=true" alt="Figure 5"><br>
<em><strong>Figure 5.</strong> Check out your .kml file in Google Earth.</em></p>
</li>
<li>
<p>Let's add models to the track! In the Placemarks tab in the Point Model options (Figure 6), click the folder icon for the "link" option and navigate to your custom made .DAE Collada file. Here we will use the one provided in example data that can be found at <a href="https://github.com/EdFarrell/MilkMachine/blob/master/sampledata/aroundtheblock/model.dae">https://github.com/EdFarrell/MilkMachine/blob/master/sampledata/aroundtheblock/model.dae</a>. Leave the longitude and latitude columns blank (they are used to override the lat/long), and uncheck the "z" checkbox. Put a 1 in for the altitude, which will set the altitude for all of the models to be 1 meter, instead of the altitude that set in the source file. Leave the scale at 1. Click "apply". </p>

<p><img src="https://github.com/EdFarrell/MilkMachine/blob/master/dist/images/example1_model.PNG?raw=true" alt="Figure 6"><br>
<em><strong>Figure 6.</strong> Model settings for gray cube .dae file.</em>  </p>

<p><img src="https://github.com/EdFarrell/MilkMachine/blob/master/dist/images/example1_model_GE.PNG?raw=true" alt="Figure 7"><br>
<em><strong>Figure 7.</strong> Gray cubes in Google Earth.</em></p>
</li>
</ol>

<h2>
<a id="example-2-create-a-kml-tour" class="anchor" href="#example-2-create-a-kml-tour" aria-hidden="true"><span class="octicon octicon-link"></span></a>Example 2: Create a .kml tour</h2>

<p>Creating a Google Earth tour in MilkMachine is easily accomplished by importing a gps file, applying models to the gps locations, then creating the tour in the "Tour" tab of MilkMachine. As noted above, the layer that you are editing in the table of contents must be open for editing in QGIS, and you must "select" the points that will be part of the tour. </p>

<p>MilkMachine supports both Google Earth <strong>Camera</strong> and <strong>LookAt</strong> based tours (see <a href="https://developers.google.com/kml/documentation/cameras">KML Camera Documentation</a>). The field names are taken directly from the KML documentation as well as the help (hover over the field for help popup). If you need more explanation of a field, use the <a href="https://developers.google.com/kml/documentation/kmlreference?hl=en">KML Reference</a>.</p>

<p>MilkMachine will only accept COLLADA files (.dae) for models. These can be made with software such as SketchUp (<a href="http://www.sketchup.com/">http://www.sketchup.com/</a>). Once imported into MilkMachine, the model can be scaled to make it larger or smaller. If you don't want the models to appear in the tour, give them a "scale" of 0 in the "Placemarks" tab.</p>

<h3>
<a id="example-2a-follow-behind-tour" class="anchor" href="#example-2a-follow-behind-tour" aria-hidden="true"><span class="octicon octicon-link"></span></a>Example 2a: Follow Behind Tour</h3>

<p>A "Follow Behind" Tour will place 1 KML camera for every GPS point. As the GPS points progress through time, the <strong>Camera</strong> will follow. The user can control the relative orientation of the <strong>Camera</strong> using MilkMachine.</p>

<ol>
<li>Follow the steps in Example 1 to import gps, and add models. In this example I am using a blue cube.</li>
<li>Remember, in order to edit you must turn editing "on" and "select" the points that will have the tour applied.</li>
<li>Open up the "Tour" tab an click the "Edit Tour" checkbox to enable the tour fields (Figure 8). Give your tour a name in the "Tour Name" box (this will appear in Google Earth). In the <strong>Camera</strong> content box choose the "Follow Behind" tab (Figure 8). </li>
<li>I would like the <strong>Camera</strong> to follow my points from above, looking down toward the ground. So, I set my altitude to 10 (meters) and the altitudemode to "relativeToModel" since the model has an altitude of it's own. This will force the altitude of the <strong>Camera</strong> to always stay 10m above the GPS point. (Figure 9)</li>
<li>The range is the horizontal distance from the GPS point. Here, I set it to 15m.</li>
<li>The tilt is the rotation of the camera measured in degrees. 0 degrees tilt would be looking straight down at the ground. A 90 degree tilt would be looking horizontal. A 180 degree tilt would be looking straight up toward the sky. Here is set it to 48 degrees (a right triangle).</li>
<li>Set the follow angle to be 180 degrees. This will set the <strong>Camera</strong> directly behind the direction of the sequential GPS points. See Figure 10 for description of follow locations.</li>
<li>Leave the default smoother number of 10. The heading angle is calculated by averaging the angles between sequential GPS points. The smoother number determines how many points are used in the averaging function. A higher number will give a "smoother" track.</li>
<li>Leave the FlyToMode set to "smooth". This will create a smooth transition between tour points.</li>
<li>
<p>Leave the "Time Stamp Duration" check box checked. This tells MilkMachine to use the time stamps as the duration of the tour points.</p>

<p><img src="https://github.com/EdFarrell/MilkMachine/blob/master/dist/images/example2_figure8.PNG?raw=true" alt="Figure 8"><br>
<em><strong>Figure 8.</strong> Create a "Follow Behind" tour in Milk Machine.</em>  </p>

<p><img src="https://github.com/EdFarrell/MilkMachine/blob/master/src/MilkMachine/camera.png?raw=true" alt="Figure 9"><br>
<em><strong>Figure 9.</strong> figure caption.</em>  </p>

<p><img src="https://github.com/EdFarrell/MilkMachine/blob/master/src/MilkMachine/followangle.png?raw=true" alt="Figure 10"><br>
<em><strong>Figure 10.</strong> figure caption.</em>  </p>
</li>
</ol>

<h2>
<a id="example-3-sync-an-audio-file-to-your-tour" class="anchor" href="#example-3-sync-an-audio-file-to-your-tour" aria-hidden="true"><span class="octicon octicon-link"></span></a>Example 3: Sync an audio file to your tour</h2>

<p>coming soon</p>

<h1>
<a id="roadmap" class="anchor" href="#roadmap" aria-hidden="true"><span class="octicon octicon-link"></span></a>Roadmap</h1>

<ul>
<li>Custom labels for icons. This will probably include a label field in the attribute table that holds text.</li>
</ul>

<h1>
<a id="authors-contributors-support" class="anchor" href="#authors-contributors-support" aria-hidden="true"><span class="octicon octicon-link"></span></a>Authors, Contributors, Support</h1>

<ul>
<li>The code was developed by Ed Farrell (<a href="https://github.com/EdFarrell" class="user-mention">@EdFarrell</a>) &amp; Sean McGinnis (<a href="https://github.com/SeanKMcGinnis" class="user-mention">@SeanKMcGinnis</a>), and is maintained by Ed. </li>
<li>MilkMachine was developed to support the 250 Miles Crossing Philadelphia Project (<a href="http://www.250miles.net/">http://www.250miles.net/</a>), featuring digital artists Esther Polak and Ivar van Bekkum (<a href="http://www.polakvanbekkum.com/">http://www.polakvanbekkum.com/</a>).</li>
<li>Support for the project came from these sources:

<ul>
<li>University City Science Center</li>
<li>Wexford Science + Technology</li>
<li>Philadelphia Redevelopment Authority </li>
<li>Drexel University</li>
</ul>
</li>
</ul>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/EdFarrell/MilkMachine">MilkMachine</a> is maintained by <a href="https://github.com/EdFarrell">EdFarrell</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-68990484-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
